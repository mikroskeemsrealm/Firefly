From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Mark Vainomaa <mikroskeem@mikroskeem.eu>
Date: Mon, 10 Jun 2019 01:18:46 +0300
Subject: [PATCH] Add gplugins command


diff --git a/proxy/src/main/java/eu/mikroskeem/firefly/command/CommandPlugins.java b/proxy/src/main/java/eu/mikroskeem/firefly/command/CommandPlugins.java
new file mode 100644
index 0000000000000000000000000000000000000000..e4d11a7cad80a29d9831bff316beda4de8048564
--- /dev/null
+++ b/proxy/src/main/java/eu/mikroskeem/firefly/command/CommandPlugins.java
@@ -0,0 +1,40 @@
+package eu.mikroskeem.firefly.command;
+
+import net.kyori.text.TextComponent;
+import net.kyori.text.format.TextColor;
+import net.md_5.bungee.api.CommandSender;
+import net.md_5.bungee.api.ProxyServer;
+import net.md_5.bungee.api.plugin.Command;
+import net.md_5.bungee.api.plugin.Plugin;
+
+import java.util.TreeMap;
+
+/**
+ * @author Mark Vainomaa
+ */
+public final class CommandPlugins extends Command {
+    public CommandPlugins() {
+        super("gplugins", "firefly.command.plugins", "gpl");
+    }
+
+    @Override
+    public void execute(CommandSender sender, String[] args) {
+        TreeMap<String, Plugin> plugins = new TreeMap<>(String.CASE_INSENSITIVE_ORDER);
+        for (Plugin plugin : ProxyServer.getInstance().getPluginManager().getPlugins()) {
+            plugins.put(plugin.getDescription().getName(), plugin);
+        }
+
+        TextComponent.Builder builder = TextComponent.builder("Plugins (" + plugins.size() + "): ");
+        boolean firstDone = false;
+        for (Plugin plugin : plugins.values()) {
+            if (firstDone) {
+                builder.append(TextComponent.of(", "));
+            }
+
+            builder.append(TextComponent.of(plugin.getDescription().getName()).color(TextColor.GREEN));
+            firstDone = true;
+        }
+
+        sender.sendMessage(builder.build());
+    }
+}
diff --git a/proxy/src/main/java/net/md_5/bungee/BungeeCord.java b/proxy/src/main/java/net/md_5/bungee/BungeeCord.java
index 4704c2c992ce06a3e1b96568ed14f2b6110cf5ed..ba5193dea1c0ade6c5ef700aa7bd633872b54167 100644
--- a/proxy/src/main/java/net/md_5/bungee/BungeeCord.java
+++ b/proxy/src/main/java/net/md_5/bungee/BungeeCord.java
@@ -285,6 +285,7 @@ public class BungeeCord extends ProxyServer
         getPluginManager().registerCommand( null, new CommandPerms() );
         // Firefly start - Fork specific commands
         getPluginManager().registerCommand(null, new eu.mikroskeem.firefly.command.CommandRestart());
+        getPluginManager().registerCommand(null, new eu.mikroskeem.firefly.command.CommandPlugins());
         // Firefly end
 
         if ( !Boolean.getBoolean( "net.md_5.bungee.native.disable" ) )
